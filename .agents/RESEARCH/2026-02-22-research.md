# Perplexity — Research

## Service
- Name: Perplexity AI
- API docs: https://docs.perplexity.ai/
- Existing CLI: No dedicated CLI exists
- Python SDK: No official Python SDK; raw HTTP API (OpenAI-compatible for chat)

## Auth
- Method: API key (Bearer token)
- Token source: `PERPLEXITY_API_KEY` env var (direct) / `OPENROUTER_API_KEY` env var (OpenRouter)
- Refresh flow: N/A — static API keys

## Key endpoints

### Direct Perplexity API
| Endpoint | Method | Purpose |
|----------|--------|---------|
| `https://api.perplexity.ai/chat/completions` | POST | Chat completions (ask, research, reason) |
| `https://api.perplexity.ai/search` | POST | Web search (raw results, no AI synthesis) |

### OpenRouter API
| Endpoint | Method | Purpose |
|----------|--------|---------|
| `https://openrouter.ai/api/v1/chat/completions` | POST | Chat completions (ask, research, reason) |

Note: The `/search` endpoint is Perplexity-only — not available via OpenRouter.

## Models

| Tool | Perplexity Model | OpenRouter Model ID |
|------|-----------------|---------------------|
| ask | `sonar-pro` | `perplexity/sonar-pro` |
| research | `sonar-deep-research` | `perplexity/sonar-deep-research` |
| reason | `sonar-reasoning-pro` | `perplexity/sonar-reasoning` |
| search | N/A (search API) | N/A (not available on OpenRouter) |

## Rate limits
- Perplexity: varies by plan; includes per-minute and daily limits
- OpenRouter: varies by plan; per-request pricing

## Four tools (matching perplexity-mcp)

1. **search** — Raw web search results (title, URL, snippet, date). Perplexity-only.
2. **ask** — Quick AI Q&A with web grounding via sonar-pro. Fast, cheap.
3. **research** — Deep multi-source research via sonar-deep-research. Slow (30s+).
4. **reason** — Step-by-step reasoning via sonar-reasoning-pro. Chain-of-thought.

## Decision
- Skill type: CLI
- Reason: No existing CLI covers these four tools with structured JSON output. Need multi-step logic for dual-provider support (Perplexity direct + OpenRouter), auth management, and response formatting (citation extraction, thinking-tag stripping).
